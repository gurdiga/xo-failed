<html>
  <head>
    <title>Tests</title>
    <meta charset="utf-8"/>
    <link rel="stylesheet" href="../node_modules/grunt-mocha-phantomjs/node_modules/mocha-phantomjs/node_modules/mocha/mocha.css" />
    <script src="http://localhost:35729/livereload.js"></script>
  </head>

  <body>
    <div id="mocha"></div>

    <!-- build:script lib -->
    <!-- /build -->

    <script>
      mocha.ui('bdd');
      mocha.reporter('html');
      expect = chai.expect;

      beforeEach(function() {
        this.sinon = sinon.sandbox.create();

        this.fakeResolvedPromise = function() {
          return {
            then: this.sinon.stub().yields()
          };
        };

        this.fakeRejectedPromise = function() {
          return {
            catch: this.sinon.stub().yields()
          };
        };
      });

      afterEach(function(){
        this.sinon.restore();
      });

    </script>

    <!-- build:script src -->
    <!-- /build -->

    <script>
      window.injector = angular.injector(['App']);
    </script>

    <!-- build:script tests -->
    <!-- /build -->

    <script>
      var runner;
      var failed = false;
      var initialTitle = document.title;

      if (window.mochaPhantomJS) mochaPhantomJS.run();
      else runner = mocha.run();

      runner.on('fail', function() {
        failed = true;
      });

      runner.on('end', function() {
        document.title = initialTitle + ' ' + (failed ? 'failâ€¦ 8-|' : 'pass! :)');
      });
    </script>

  </body>
</html>
